<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://kit.fontawesome.com/c393d9e7a8.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="../assets/css/reset.css">
    <link rel="stylesheet" href="../assets/css/detail.css">
    <script src="../assets/vendor/jquery-1.12.4.min.js"></script>
    <title>초월홍삼</title>
</head>
<body>
    <div class="project_wrap">
        <h1 class="title">초월홍삼</h1>
        <div class="basic_info">
            <a href="http://naturalhc.uwal.co.kr/" target="_blank" class="go_link">
                <i class="fas fa-link"></i>
                사이트 바로가기
            </a>
            <p class="desc">
                <i>-</i>랜딩페이지(반응형)
            </p>
            <p class="desc">
                <i>-</i>퍼블리싱 100%
            </p>
        </div>
        <p class="desc">
            <i>-</i>
            각 섹션마다 스크롤 애니메이션이 적용 되었습니다.
        </p>
        <p class="desc">
            <i>-</i>
            차트가 다양하게 들어가 있어서 모든 차트에 애니메이션이 적용 되도록 작업하였습니다.
        </p>
        <div class="detail_box">
            <h2 class="sub_ttl">Detail</h2>
            <p class="desc">
                <i>-</i>
                애니메이션도 많이 들어가고, 스크롤 애니메이션이 시작되는 분기점도 조금씩 달라서, 애니메이션이 필요한 부분에 ani_div라는 클래스명을 추가하고 배열로 받아서 스크롤 이벤트 내에 for문을 사용하여 매칭이 되면 on클래스를 추가하고 배열의 요소를 삭제되도록 스크립트를 작성하였습니다.
            </p>
            <div class="code_box">
                <div class="colorscripter-code" style="color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto;"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#fafafa;border-radius:4px;width: 100%;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #e5e5e5"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#666;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div><div style="line-height:130%">10</div><div style="line-height:130%">11</div><div style="line-height:130%">12</div><div style="line-height:130%">13</div><div style="line-height:130%">14</div><div style="line-height:130%">15</div><div style="line-height:130%">16</div><div style="line-height:130%">17</div><div style="line-height:130%">18</div><div style="line-height:130%">19</div><div style="line-height:130%">20</div><div style="line-height:130%">21</div><div style="line-height:130%">22</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">var</span>&nbsp;aniDiv&nbsp;<span style="color:#ff3399"></span><span style="color:#a71d5d">=</span>&nbsp;<span style="color:#066de2">document</span>.querySelectorAll(<span style="color:#63a35c">".ani_div"</span>);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">var</span>&nbsp;aniDivArry&nbsp;<span style="color:#ff3399"></span><span style="color:#a71d5d">=</span>&nbsp;<span style="color:#a71d5d">new</span>&nbsp;<span style="color:#066de2">Array</span>();</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#066de2">Array</span>.<span style="color:#066de2">prototype</span>.forEach.call(aniDiv,&nbsp;<span style="color:#a71d5d">function</span>&nbsp;(ele)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aniDivArry.push(ele);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;});</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;$(<span style="color:#066de2">window</span>).on(<span style="color:#63a35c">'scroll'</span>,&nbsp;<span style="color:#a71d5d">function</span>&nbsp;()&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">var</span>&nbsp;scrollTop&nbsp;<span style="color:#ff3399"></span><span style="color:#a71d5d">=</span>&nbsp;$(<span style="color:#066de2">window</span>).scrollTop(),</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;windowH&nbsp;<span style="color:#ff3399"></span><span style="color:#a71d5d">=</span>&nbsp;$(<span style="color:#066de2">window</span>).height()&nbsp;<span style="color:#ff3399"></span><span style="color:#a71d5d">/</span>&nbsp;<span style="color:#0099cc">3</span>&nbsp;<span style="color:#ff3399"></span><span style="color:#a71d5d">*</span>&nbsp;<span style="color:#0099cc">2</span>;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">for</span>&nbsp;(<span style="color:#a71d5d">var</span>&nbsp;i&nbsp;<span style="color:#ff3399"></span><span style="color:#a71d5d">=</span>&nbsp;<span style="color:#0099cc">0</span>;&nbsp;i&nbsp;<span style="color:#ff3399"></span><span style="color:#a71d5d">&lt;</span>&nbsp;aniDivArry.<span style="color:#066de2">length</span>;&nbsp;i<span style="color:#ff3399"></span><span style="color:#a71d5d">+</span><span style="color:#ff3399"></span><span style="color:#a71d5d">+</span>)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">if</span>&nbsp;($(aniDivArry[i]).offset().top&nbsp;<span style="color:#ff3399"></span><span style="color:#a71d5d">&lt;</span>&nbsp;scrollTop&nbsp;<span style="color:#ff3399"></span><span style="color:#a71d5d">+</span>&nbsp;windowH)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(aniDivArry[i]).addClass(<span style="color:#63a35c">'on'</span>);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aniDivArry.splice(i,&nbsp;<span style="color:#0099cc">1</span>);&nbsp;<span style="color:#999999">//&nbsp;on&nbsp;class&nbsp;붙으면&nbsp;요소&nbsp;삭제</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;});</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div></div><div style="text-align:right;margin-top:-13px;margin-right:5px;font-size:9px;font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#e5e5e5text-decoration:none">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#e5e5e5;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>
            </div>
        </div>
        <div class="detail_box">
            <h2 class="sub_ttl">Detail</h2>
            <img src="../assets/img/detail/naturalhc_detail01.jpg" alt="">
            <p class="desc">
                <i>-</i>
                도넛차트는 캔버스를 이용하여 애니메이션을 적용하였습니다. 
            </p>
            <a href="https://tassi.tistory.com/8" target="_blank" class="go_link">
                <i class="fas fa-link"></i>
                포스팅 보러가기
            </a>
            
            <div class="chart_area">
                <button type="button" class="animation_start">도넛 애니메이션 시작</button>
                <div class="chart_box">
                    <div class="chart_in">
                        <canvas id="chare_canvas"></canvas>
                    </div>
                </div>
            </div>
        </div>
        <div class="detail_box">
            <h2 class="sub_ttl">Detail</h2>
            <img src="../assets/img/detail/naturalhc_detail02.jpg" alt="">
            <p class="desc">
                <i>-</i>
                라인 차트는 반응형이기 때문에 선의 길이와 각도가 차트 영역이 변함에 따라서 값이 유동적으로 바뀌어야 했기에 스크립트를 사용하여 작업하였습니다.
            </p>
            <a href="https://tassi.tistory.com/9" target="_blank" class="go_link">
                <i class="fas fa-link"></i>
                포스팅 보러가기
            </a>
        </div>
        <div class="detail_box">
            <h2 class="sub_ttl">Main Page</h2>
            <img src="../assets/img/detail/naturalhc_main.jpg" alt="">
        </div>
    </div>

    <script>
        $(function() {
            
            function circleChartAnimation (option) {
                var length = option.val.length;
                var circleCanvas = option.canvas;
                var circleCanvasCtx = circleCanvas.getContext('2d');
                // canvas 레티나 대응
                // var devicePixelRatio, backingStoreRatio, ratio;
                //     devicePixelRatio = window.devicePixelRatio || 1,
                //     backingStoreRatio = circleCanvasCtx.webkitBackingStorePixelRatio ||
                //     circleCanvasCtx.mozBackingStorePixelRatio ||
                //     circleCanvasCtx.msBackingStorePixelRatio ||
                //     circleCanvasCtx.oBackingStorePixelRatio ||
                //     circleCanvasCtx.backingStorePixelRatio || 1,
                //     ratio = devicePixelRatio / backingStoreRatio;
                circleCanvas.width = $('.chart_box').width() * 2;
                circleCanvas.height = $('.chart_box').height() * 2;
                // circleCanvasCtx.scale(ratio, ratio);
            
                var circleCenterX = circleCanvas.width / 2;
                var circleCenterY = circleCanvas.height / 2;
                var circleRadius = Math.min(circleCenterX, circleCenterY);
                var startAngle = 0;
                var endAngle;
                var total = 0;
                var val = new Array();
                var stepAngle = startAngle;
                var maxDeg;
                var pieIdx = 0;
            
                // 비율 최종값, 배열 넘기기
                for(i = 0; i < length; i++) {
                    total += option.val[i]; 
                    val.push(option.val[i]);
                }
            
                // 시작값 넣어주기
                endAngle = 2 * Math.PI * val[pieIdx] / total; // 비율에 따라 호도각 산출
                maxDeg =  endAngle * 180 / Math.PI;// 호도각 -> 일반각

            
                // 반복되는 부분
                var circleChartMove = setInterval(function(){
                    
                    if(pieIdx >= length){
                        // 모든 파이가 그려지면
                        clearInterval(circleChartMove);
                    }
            
                    if(stepAngle > maxDeg) {
                        // 파이 한조각이 완성되면
                        pieIdx = pieIdx + 1;
                        startAngle += endAngle;
                        if (pieIdx < length) {
                            // 값 갱신
                            endAngle = 2 * Math.PI * val[pieIdx] / total;
                            maxDeg = maxDeg + endAngle * 180 / Math.PI;
                        }
                    } else {
            
                        // 파이 한조각 완성전
                        stepAngle++;
                        
                        circleCanvasCtx.fillStyle = option.colors[pieIdx];
                        circleCanvasCtx.beginPath();
                        circleCanvasCtx.moveTo(circleCenterX, circleCenterY);
                        circleCanvasCtx.arc(circleCenterX, circleCenterY, circleRadius, startAngle, stepAngle * Math.PI / 180);
                        circleCanvasCtx.closePath();
                        circleCanvasCtx.fill();

                        // 도넛 그림자
                        circleCanvasCtx.beginPath();
                        circleCanvasCtx.moveTo(circleCenterX, circleCenterY);
                        circleCanvasCtx.fillStyle = 'rgba(0,0,0,.1)';
                        circleCanvasCtx.arc(circleCenterX, circleCenterY, circleRadius/2 + 50, startAngle, stepAngle * Math.PI / 180);
                        circleCanvasCtx.closePath();
                        circleCanvasCtx.fill();

                        // 도넛 홀
                        circleCanvasCtx.beginPath();
                        circleCanvasCtx.moveTo(circleCenterX, circleCenterY);
                        circleCanvasCtx.fillStyle = '#fff';
                        circleCanvasCtx.arc(circleCenterX, circleCenterY, circleRadius/2, 0, Math.PI / 180 * 360);
                        circleCanvasCtx.closePath();
                        circleCanvasCtx.fill();

                    }
            
                }, 5);
            
            }

            circleChartAnimation ({
                canvas: document.getElementById("chare_canvas"),
                val: [12, 28, 10],
                colors: ["#cfcfcf", "#414b67", "#828485"]
            });

            $('.animation_start').on('click', function() {
                circleChartAnimation ({
                    canvas: document.getElementById("chare_canvas"),
                    val: [12, 28, 10],
                    colors: ["#cfcfcf", "#414b67", "#828485"]
                });
            })
        })
    </script>
</body>
</html>